<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>eBPF in action</title>
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			  crossorigin="anonymous"></script>
		
        <style>
            html,body{
                margin:0;
                padding:0;
                overflow: hidden;                
            }

            #controlButton{
                text-align:center;
            }
            button{
	            background-color: #72A2C0;
	            border-radius: 4px;
	            color:white;

                width: 80%;
	            padding: 12px 20px;
	            margin: 8px 0;
	            display: inline-block;
	            border: 1px solid #ccc;
	            border-radius: 4px;
	            box-sizing: border-box;
	            font-size:150%;
            }
            button:hover{
	            cursor:pointer;
	            background-color: #1D65A6;	
            }
        </style>

	</head>

	<body>
		<canvas id="ebpfInAction" width="500px" height="450px">

        </canvas>
			
        <div id="controlButton">
		    <button id="animEBPF">Start eBPF</button>
        </div>
        <script>
            var timerJavascripteBPF = false;
            var canvasWidtheBPF;
            var canvasHeighteBPF;

            var canvaseBPF;
            var contexteBPF;
  
            var animateSceneEBPF = true;


            var mainContainer = function(x, y, width, height,color, text, colorText){
	            this.x = x;
	            this.y = y;
	            this.width = width;
	            this.height = height;
	            this.color = color;
	            this.text = text;
	            this.colorText = colorText;
	
            }

            var linux_container_userspace; 
            var linux_container_kernel;
            var linux_container_kernel_EBPF_VM;


            $(document).ready(function(e){
                
                canvaseBPF = $("#ebpfInAction");
                contexteBPF = canvaseBPF.get(0).getContext("2d");
                canvasWidtheBPF = canvaseBPF.width();
                canvasHeighteBPF = canvaseBPF.height();


                resizeCanvaseBPF();
        	    $(window).resize(resizeCanvaseBPF);

               
		        
		        $("#animEBPF").on("click",function() {
			
			        if(animateSceneEBPF){
				        animateSceneEBPF = false;
				
			
			        }
			        else {
				        animateSceneEBPF = true;
				
			        }
				
			        resizeCanvaseBPF();
			
		        });

            });


            function drawUserSpaceEBPF(){
			    linux_container_userspace = new mainContainer(canvasWidtheBPF/12,50,canvasWidtheBPF/2.5,canvasHeighteBPF - 100,"#D9AC2A", "Userspace","rgba(255,255,255,1.0)");

			    contexteBPF.fillStyle = linux_container_userspace.color;
			    contexteBPF.fillRect(linux_container_userspace.x, linux_container_userspace.y, linux_container_userspace.width, linux_container_userspace.height);

			
			    contexteBPF.fillStyle = linux_container_userspace.colorText;
			    contexteBPF.font = "30px serif";
			    contexteBPF.fillText(linux_container_userspace.text, linux_container_userspace.x + linux_container_userspace.width/2 - 65, linux_container_userspace.y+35);
		    }



            function drawUserKernelEBPF(){
			    linux_container_kernel = new mainContainer(canvasWidtheBPF/2,50,canvasWidtheBPF/2,canvasHeighteBPF - 100,"#00AC2A", "Kernel","rgba(255,255,255,1.0)");

			    contexteBPF.fillStyle = linux_container_kernel.color;
			    contexteBPF.fillRect(linux_container_kernel.x, linux_container_kernel.y, linux_container_kernel.width, linux_container_kernel.height);

			
			    contexteBPF.fillStyle = linux_container_kernel.colorText;
			    contexteBPF.font = "30px serif";
			    contexteBPF.fillText(linux_container_kernel.text, linux_container_kernel.x + linux_container_kernel.width/2 - 50, linux_container_kernel.y+35);
		    }



            function drawUserKernelEBPF_VM(){
			    linux_container_kernel_EBPF_VM = new mainContainer(linux_container_kernel.x,50,linux_container_kernel.width/3,linux_container_kernel.height/3, "#00ACBB", "eBPF","rgba(255,255,255,1.0)");

			    contexteBPF.fillStyle = linux_container_kernel_EBPF_VM.color;
			    contexteBPF.fillRect(linux_container_kernel_EBPF_VM.x + (linux_container_kernel.width-linux_container_kernel_EBPF_VM.width)/2, linux_container_kernel_EBPF_VM.y + (linux_container_kernel.height-linux_container_kernel_EBPF_VM.height)/2, linux_container_kernel_EBPF_VM.width, linux_container_kernel_EBPF_VM.height);

			
			    contexteBPF.fillStyle = linux_container_kernel_EBPF_VM.colorText;
			    contexteBPF.font = "30px serif";
			    contexteBPF.fillText(linux_container_kernel_EBPF_VM.text, linux_container_kernel_EBPF_VM.x + (linux_container_kernel.width-linux_container_kernel_EBPF_VM.width)/2 + linux_container_kernel_EBPF_VM.width/2 - 33, linux_container_kernel_EBPF_VM.y+35 + (linux_container_kernel.height-linux_container_kernel_EBPF_VM.height)/2);

                contexteBPF.fillText("VM", linux_container_kernel_EBPF_VM.x + linux_container_kernel_EBPF_VM.width/2 - 25 + (linux_container_kernel.width-linux_container_kernel_EBPF_VM.width)/2, linux_container_kernel_EBPF_VM.y+linux_container_kernel_EBPF_VM.height/2+13 + (linux_container_kernel.height-linux_container_kernel_EBPF_VM.height)/2);
		    }


            function drawEBPFScene(){
           		contexteBPF.clearRect(0, 0, canvasWidtheBPF, canvasHeighteBPF);


            
                drawUserSpaceEBPF();
                drawUserKernelEBPF();
                drawUserKernelEBPF_VM();


                if(animateSceneEBPF){
                        $("#animEBPF").text('Start eBPF');
             			timerJavascript = setTimeout(drawEBPFScene, 1000);

                }


				else{
					$("#animEBPF").text('Stop eBPF');
			    }
            }


            function resizeCanvaseBPF(){
                if(timerJavascripteBPF)
                    clearTimeout(timerJavascripteBPF);
                canvaseBPF.attr("width",$(window).get(0).innerWidth - 100);
                canvaseBPF.attr("height",$(window).get(0).innerHeight - 120);
                canvasWidtheBPF = canvaseBPF.width();
                canvasHeighteBPF = canvaseBPF.height();
                    
                drawEBPFScene();                        
            }
        </script>

	</body>

</html>
